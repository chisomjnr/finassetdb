<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8">
    <title> FinAsset  | Customer Accounts </title>
    <link rel="stylesheet" href="home.css">
    <link rel="stylesheet" href="costumer-account.css">
    <link
    href="https://cdn.jsdelivr.net/npm/remixicon@4.1.0/fonts/remixicon.css"
    rel="stylesheet"
  />
    <link
    href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css"
    rel="stylesheet"
  />


  <meta name="title" content="Welcome to FinAsset">
  <meta name="description" content="FinAsset is your comprehensive solution for efficient asset management. Track, manage, and optimize your assets with ease.">
  

  <link rel="icon" href="assets/social (2).png" type="image/x-icon">
    <!-- Boxicons CDN Link -->
    <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* Additional styles for the submenu */
     .submenu {
         background: #312b1b;
         padding: 10px;
         border-radius: 10px;
         margin-top: 10px;
         overflow: hidden;  /* Important for the dropdown effect */
         max-height: 0;     /* Start with height 0 (collapsed) */
         transition: max-height 0.4s ease, padding 0.4s ease; /* Animate max-height and padding */
     }
     
     .line {
         border-bottom: 1px solid #2b284b;
     }
     
     .line2 {
         border-bottom: 2px solid #bab9cb;
         margin-left: 30px;
         margin-right: 30px;
     }
     
     .submenu, .nested-submenu, .nested-submenu2 {
         list-style-type: none;
         max-height: 0; /* Initially set max-height to 0 for hidden state */
         padding: 0;    /* Collapse padding initially */
     }
     
     .submenu li, .nested-submenu li, .nested-submenu2 li {
         padding: 1px;
     }
     
     .submenu li a, .nested-submenu li a, .nested-submenu2 li a {
         color: #fff;
         text-decoration: none;
         padding-left: 20px;
         background: transparent;
     }
     
     .submenu li i, .nested-submenu li i, .nested-submenu2 li i {
         font-size: 20px;
     }
     
     .submenu li a:hover {
         background: #1d1b31;
         color: white;
     }
     
     .submenu .dropdown-toggle {
         background: #E4E9F7;
         color: black;
     }
     
     .submenu .dropdown-toggle i {
         color: black;
     }
     
     .dropdown-toggle {
         display: flex;
         justify-content: space-between;
         align-items: center;
     }
     
     .rotate {
         transform: rotate(180deg);
     }
     
     /* Class for when submenu is open */
     .submenu.open {
         max-height: 500px; /* A large enough height to fit the content */
         padding: 10px;     /* Restore padding when open */
         transition: max-height 0.5s ease, padding 0.4s ease; /* Smooth dropdown animation */
     }
     
     
           </style>



  </head>
<body>
    <div class="sidebar">
        <div class="logo-details">
            <img src="assets/social (1).png" alt="">
            <div class="logo_name">FinAsset<span id="span">.</span></div>
            <i class='bx bx-menu' id="btn" ></i>
        </div>
        <ul class="nav-list">
          <li>
              <i class='bx bx-search' ></i>
             <input type="text" placeholder="Search in sidebar...">
             <span class="tooltip">Search</span>
          </li>
          
          <li>
            <a href="index.html">
              <i class='bx bx-home-alt'></i>
              <span class="links_name">Home</span>
            </a>
             <span class="tooltip">Home</span>
          </li>
    
          <li>
            <a  href="notification.html">
              <i class='bx bx-bell'></i>
              <span class="links_name">Notifications</span>
            </a>
            <span class="tooltip">Notifications</span>
          </li>
    
          <li>
            <a   href="finai.html">
                <i class='bx bx-grid-alt'></i>
              <span class="links_name">Fin Ai | <strong>Coming Soon</strong></span>
            </a>
            <span class="tooltip">Fin Ai</span>
          </li>
    <br>
          <div class="line"></div>
          <br>
    
    
          <!-- Customer Management with Submenu -->
          <li>
           <a href="#"  class="dropdown-toggle" id="customerManagementBtn">
             <div>
               <i class='bx bx-user'></i>
               <span class="links_name">Customer Management</span>
             </div>
             <i class='bx bx-chevron-down' id="customerChevron"></i>
           </a>
           <ul class="submenu" id="customerManagementSubmenu">
             <li><a href="#"> <i class='bx bx-circle'></i> Home</a></li>
             <li><a href="#"> <i class='bx bx-circle'></i> Customers</a></li>
             <li><a href="#"> <i class='bx bx-circle'></i> Messaging</a></li>
             <li><a href="#"> <i class='bx bx-circle'></i> Reports</a></li>
           </ul>
           <span class="tooltip">Customer Management</span>
         </li>
    
       <!-- Customer Account Menu -->
    <li>
        <a href="javascript:void(0)" class="dropdown-toggle" id="customerAccountBtn">
            <div>
                <i class='bx bxs-user-account'></i>
                <span class="links_name">Customer Account</span>
               
            </div>
            <i class='bx bx-chevron-down' id="customerAccountChevron"></i>
        </a>
        <ul class="submenu" id="customerAccountSubmenu">
            <li><a id="active" href="customer-account-home.html"> <i class='bx bx-circle'></i> Home</a></li>
            <li><a href="#"> <i class='bx bx-circle'></i> Setup</a></li>
            <li><a href="#"> <i class='bx bx-circle'></i> Operations</a></li>
            <li><a href="#"> <i class='bx bx-circle'></i> Reports</a></li>
        </ul>
        <span class="tooltip">Customer Account</span>
    </li>
    
    
         <!-- Assets Management -->
         <li>
           <a href="#" class="dropdown-toggle" id="assetManagementBtn">
             <div>
               <i class='bx bx-pie-chart-alt-2'></i>
               <span class="links_name">Asset Management</span>
             </div>
             <i class='bx bx-chevron-down' id="chevron"></i>
           </a>
           <ul class="submenu" id="assetManagementSubmenu">
             <li><a href="#"> <i class='bx bx-circle'></i> Home</a></li>
             <li><a href="#"> <i class='bx bx-circle'></i> Setup</a></li>
             <li><a href="#"> <i class='bx bx-circle'></i> Individual Funds</a></li>
             <li>
    
                <li> <a href="#" class="dropdown-toggle" id="nonUtilizedFundsBtn">
                      <span> Non Utilized Funds</span>
                    <i class='bx bx-chevron-down' id="nonUtilizedChevron"></i>
                  </a></li>
               
               <ul class="nested-submenu" id="nonUtilizedFundsSubmenu">
                <li><a href="#"> <i class='bx bx-circle'></i> Fund Management</a></li>
                <li><a href="#"> <i class='bx bx-circle'></i> Fees</a></li>
                <li><a href="#"> <i class='bx bx-circle'></i> Enquiries</a></li>
                <li>
                    <a href="#" class="dropdown-toggle" id="depositsBtn">
                      <div>
                        <span> > Deposits</span>
                      </div>
                      <i class='bx bx-chevron-down' id="depositsChevron"></i>
                    </a>
                    <ul class="nested-submenu2" id="depositsSubmenu">
                      <li><a href="#"> <i class='bx bx-circle'></i> Calculator</a></li>
                      <li><a href="#"> <i class='bx bx-circle'></i> Lien</a></li>
                      <li><a href="#"> <i class='bx bx-circle'></i> Amendments</a></li>
                      <li><a href="#"> <i class='bx bx-circle'></i> Withdraw</a></li>
                      <li>
                        <a href="#" class="dropdown-toggle" id="deposits2Btn">
                          <div>
                            <span> > Deposits</span>
                          </div>
                          <i class='bx bx-chevron-down' id="deposits2Chevron"></i>
                        </a>
                        <ul class="nested-submenu2" id="deposits2Submenu">
                          <li><a href="#"> <i class='bx bx-circle'></i> Call Deposits</a></li>
                          <li><a href="#"> <i class='bx bx-circle'></i> Fixed Deposits</a></li>
                          <li><a href="#"> <i class='bx bx-circle'></i> Additional Deposits</a></li>
                          <li><a href="#"> <i class='bx bx-circle'></i> Merge Deposits</a></li>
                        </ul>
                      </li>
                    </ul>
                  </li>
               </ul>
             </li>
           </ul>
           <span class="tooltip">Assets</span>
         </li>
    
         
    
        <!-- Account Management with Submenu -->
    <li>
        <a href="#" class="dropdown-toggle" id="accountManagementBtn">
          <div>
            <i class='bx bx-user-circle'></i>
            <span class="links_name">Account Management</span>
          </div>
          <i class='bx bx-chevron-down' id="accountManagementChevron"></i>
        </a>
        <ul class="submenu" id="accountManagementSubmenu">
          <li><a href="#"> <i class='bx bx-circle'></i> Account Info</a></li>
          <li><a href="#"> <i class='bx bx-circle'></i> Account Settings</a></li>
          <li><a href="#"> <i class='bx bx-circle'></i> Billing</a></li>
          <li><a href="#"> <i class='bx bx-circle'></i> Security</a></li>
        </ul>
        <span class="tooltip">Account Management</span>
      </li>
    
      
         <li>
           <a href="administrator.html">
             <i class='bx bx-cart-alt'></i>
             <span class="links_name">Administrator</span>
           </a>
           <span class="tooltip">Administrator</span>
         </li>
    
       
         <br>
         <div class="line"></div>
         <br>

         <li>
            <a href="Learn.html">
              <i class='bx bx-book'></i>
              <span class="links_name">Help Guide</span>
            </a>
            <span class="tooltip">Help</span>
          </li>
    
          <li>
            <a   href="support.html">
                <i class='ri-customer-service-2-line'></i>
              <span class="links_name">Our Support</span>
            </a>
            <span class="tooltip">Support</span>
          </li>

          <li>
            <a   href="support.html">
                <i class='bx bx-gri-alt'></i>
              <span class="links_name"></span>
            </a>
         
          </li>
 
         <br>
         <br>
         <li class="profile">
             <div class="profile-details">
               <div class="name_job">
                 <div class="name">Company Name</div>
                 <div class="job">by <strong>Globalseam</strong></div>
               </div>
             </div>
             <i class='bx bx-log-out' id="log_out"></i>
    
         </li>
        </ul>
      </div>



  <!-- Main Screen -->

  <section class="home-section">
    <header>
        <div class="text">
           FinAsset  <i class="bx bx-chevron-right"></i> Customer Accounts <i class="bx bx-chevron-right"></i> <span style="color: orange; background: #ccd1dd; padding: 8px 20px; border-radius: 20px; cursor: pointer;"><i class="bx bx-home"></i>Home</span>
        </div>

        <div class="header-content">
            <!-- <h1>Your Website Title</h1> -->
         
        </div>

        <div class="header-content">
            <!-- <h1>Your Website Title</h1> -->
            <div class="search-container">
                <i class="bx bx-search"></i>
                <input type="text" placeholder="Search...">
                <button type="submit">GO</button>
            </div>
           
        </div>
    </header>

    <style>
      .popup-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.7);
          display: none;
          justify-content: center;
          align-items: center;
          z-index: 999;
          overflow-y: scroll;
          scrollbar-width: none; /* For Firefox */
      }
  
      .popup-form {
          background-color: white;
          padding: 30px;
          border-radius: 10px;
          max-width: 800px;
          width: 100%;
          transform: translateY(100%);
          animation: slide-in 0.5s forwards;
      }
  
      @keyframes slide-in {
          from {
              transform: translateY(100%);
          }
          to {
              transform: translateY(0);
          }
      }
  
      /* Show the popup */
      .show-popup {
          display: flex;
      }
  
      /* Horizontal scrollable table */
      .table-wrapper {
          overflow-x: auto;
          padding: 10px;
          margin-top: 10px;
      }
  
      .accounts-table {
          width: 100%;
          min-width: 1500px; /* Set minimum width to allow horizontal scrolling */
          border-collapse: collapse;
      }
  
      .accounts-table th, .accounts-table td {
          padding: 10px;
          text-align: left;
          border-bottom: 1px solid #ddd;
      }
  
      /* Scrollbar styling */
      .table-wrapper::-webkit-scrollbar {
          height: 3px;
      }
  
      .table-wrapper::-webkit-scrollbar-thumb {
          background-color: orange;
          border-radius: 10px;
      }
  
      .table-wrapper::-webkit-scrollbar-thumb:hover {
          background-color: #343434;
      }
  
      .table-wrapper::-webkit-scrollbar {
          background-color: #f1f1f1;
      }
  
  </style>
  
  <div style="display: flex; justify-content: space-between; align-items: center; padding: 30px;">
      <div style="text-align: left;">
             <h1 style="font-size: 55px; color: #181818; line-height: 1.2;" line-height: 1.2;">Customer Accounts</h1>
      </div>
  </div>
  
  <br>
  
  <!-- Main Content Area -->
  <main>
      <div class="content-header">
          <h2>Dashboard</h2>
          <button class="add-btn" id="openPopupBtn"><i class="bx bx-upload"></i> Add New</button>
      </div>
  
      <!-- Customer Accounts Table -->
      <div class="table-wrapper">
          <table class="accounts-table" id="accountsTable">
              <thead>
                  <tr>
                      <th><input type="checkbox"></th>
                      <th>Customer ID</th>
                      <th>Name</th>
                      <th>Email</th>
                      <th>Password</th>
                      <th>Time Joined</th>
                      <th>Date Joined</th>
                      <th>Account Status</th>
                      <th>Actions</th>
                  </tr>
              </thead>
              <tbody>
                  <tr>
                      <td><input type="checkbox"></td>
                      <td>CUST001</td>
                      <td>John Doe</td>
                      <td>john.doe@example.com</td>
                      <td>*******</td>
                      <td>10:30 AM</td>
                      <td>2024-10-05</td>
                      <td class="status active">Active</td>
                      <td>
                          <button class="view-btn">View</button>
                          <button class="edit-btn">Edit</button>
                          <button class="delete-btn">Delete</button>
                      </td>
                  </tr>
              </tbody>
          </table>
      </div>
  </main>
  
  <!-- Popup Form for Add New -->
  <div class="popup-overlay" id="popupOverlay">
      <div class="popup-form">
          <section class="body">
              <section class="container">
                  <header>
                      <h1 style="font-size: 25px;">FinAsset<strong style="color: orange;">.</strong></h1>
                  </header>
                <header id="popupHeader">Create Customer</header> <!-- Header changes dynamically -->
       <form action="#" class="form" id="customerForm">
                      <div class="input-box address">
                          <label style="color: orange;">Details</label>
                          <div class="column">
                              <input type="text" id="firstName" placeholder="First Name" required />
                              <input type="text" id="lastName" placeholder="Last Name" required />
                          </div>
                          <div class="column">
                              <input type="email" id="email" placeholder="Email" required />
                          </div>
                          <div class="column">
                              <input type="text" id="customerID" placeholder="Customer ID" readonly />
                          </div>

                          <div class="column">
                            <input type="password" id="password" placeholder="Password" required />
                        </div>
                      </div>
                  
                      <button type="submit" id="commitChangesBtn">Commit Changes</button>
                  </form>
              </section>
          </section>
      </div>
  </div>

    <script>
    const openPopupBtn = document.getElementById('openPopupBtn');
    const popupOverlay = document.getElementById('popupOverlay');
    const customerForm = document.getElementById('customerForm');
    const accountsTable = document.getElementById('accountsTable').getElementsByTagName('tbody')[0];
    let customerCount = 1;
    let editingCustomerIndex = null;

    // Load saved customers from localStorage on page load
    document.addEventListener('DOMContentLoaded', loadCustomers);

    // Open the popup for "Create Customer"
    openPopupBtn.addEventListener('click', () => {
        openPopup('create');
        generateCustomerID(); // Generate Customer ID when popup opens
    });

    // Close popup when clicking outside
    popupOverlay.addEventListener('click', (event) => {
        if (event.target === popupOverlay) {
            popupOverlay.classList.remove('show-popup');
        }
    });

// Open Popup for Create, View, or Edit mode
function openPopup(mode, customer = null) {
    if (mode === 'create') {
        popupHeader.textContent = 'Create Customer'; // Set popup header
        generateCustomerID(); // Generate a new Customer ID
        customerForm.reset(); // Reset form fields for a new customer
        editingCustomerIndex = null;
        toggleFormEditable(true); // Make form editable for create
    } else if (mode === 'edit' || mode === 'view') {
        popupHeader.textContent = mode === 'edit' ? 'Edit Customer' : 'View Customer'; // Change header based on mode
        fillFormWithCustomerData(customer); // Populate form with customer data
        editingCustomerIndex = customer.index;
        toggleFormEditable(mode === 'edit'); // Make form editable only in edit mode
    }
    popupOverlay.classList.add('show-popup'); // Show the popup
}

// Fill the form with customer data (used for View and Edit)
function fillFormWithCustomerData(customer) {
    document.getElementById('customerID').value = customer.customerID;
    const [firstName, lastName] = customer.name.split(' ');
    document.getElementById('firstName').value = firstName;
    document.getElementById('lastName').value = lastName;
    document.getElementById('email').value = customer.email;
    document.getElementById('password').value = customer.password;
}


    // Generate Customer ID automatically
    function generateCustomerID() {
        customerCount++; // Increment customer count for each new customer
        const customerIDInput = document.getElementById('customerID');
        customerIDInput.value = 'CUST' + ('000' + customerCount).slice(-3);
    }

    // Get current time in HH:MM AM/PM format
    function getCurrentTime() {
        const now = new Date();
        let hours = now.getHours();
        let minutes = now.getMinutes();
        const ampm = hours >= 12 ? 'PM' : 'AM';
        hours = hours % 12;
        hours = hours ? hours : 12; // hour '0' should be '12'
        minutes = minutes < 10 ? '0' + minutes : minutes;
        return hours + ':' + minutes + ' ' + ampm;
    }

    // Get current date in YYYY-MM-DD format
    function getCurrentDate() {
        const now = new Date();
        return now.toISOString().split('T')[0];
    }

    // Handle form submission to add a new or edit existing customer
    customerForm.addEventListener('submit', (event) => {
        event.preventDefault(); // Prevent form from refreshing the page

        // Get form values
        const firstName = document.getElementById('firstName').value;
        const lastName = document.getElementById('lastName').value;
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        const customerID = document.getElementById('customerID').value;
        const timeJoined = getCurrentTime();
        const dateJoined = getCurrentDate();

        // Create or Update customer object
        const newCustomer = {
            customerID,
            name: `${firstName} ${lastName}`,
            email,
            password,
            timeJoined,
            dateJoined,
            status: 'Active'
        };

        if (editingCustomerIndex === null) {
            // New customer (Create mode)
            addCustomerToTable(newCustomer);
            saveCustomer(newCustomer);
        } else {
            // Edit existing customer
            updateCustomer(newCustomer, editingCustomerIndex);
        }

        // Close the popup after adding/editing
        popupOverlay.classList.remove('show-popup');
        customerForm.reset();
        generateCustomerID();
    });

    // Fill the form with customer data (used for View and Edit)
    function fillFormWithCustomerData(customer) {
        document.getElementById('customerID').value = customer.customerID;
        const [firstName, lastName] = customer.name.split(' ');
        document.getElementById('firstName').value = firstName;
        document.getElementById('lastName').value = lastName;
        document.getElementById('email').value = customer.email;
        document.getElementById('password').value = customer.password;
    }

    // Toggle form editable (used for View/Edit modes)
    function toggleFormEditable(isEditable) {
        const formInputs = customerForm.querySelectorAll('input');
        formInputs.forEach(input => input.readOnly = !isEditable);
        const commitButton = customerForm.querySelector('button[type="submit"]');
        commitButton.style.display = isEditable ? 'block' : 'none'; // Hide button if not editable
    }

    // Add customer to the table
    function addCustomerToTable(customer) {
        const newRow = accountsTable.insertRow();
        newRow.innerHTML = `
            <td><input type="checkbox"></td>
            <td>${customer.customerID}</td>
            <td>${customer.name}</td>
            <td>${customer.email}</td>
            <td>${'*'.repeat(customer.password.length)}</td> <!-- Password masked with * -->
            <td>${customer.timeJoined}</td>
            <td>${customer.dateJoined}</td>
            <td class="status active">${customer.status}</td>
            <td>
                <button class="view-btn" onclick="viewCustomer(${accountsTable.rows.length - 1})">View</button>
                <button class="edit-btn" onclick="editCustomer(${accountsTable.rows.length - 1})">Edit</button>
                <button class="delete-btn" onclick="deleteCustomer(${accountsTable.rows.length - 1})">Delete</button>
            </td>
        `;
    }

    // Save a customer to localStorage
    function saveCustomer(customer) {
        let customers = JSON.parse(localStorage.getItem('customers')) || [];
        customers.push(customer);
        localStorage.setItem('customers', JSON.stringify(customers));
    }

    // Load customers from localStorage and populate the table
    function loadCustomers() {
        let customers = JSON.parse(localStorage.getItem('customers')) || [];
        customers.forEach((customer, index) => {
            customer.index = index;
            addCustomerToTable(customer);
        });
        customerCount = customers.length; // Update customer count to match saved customers
    }

     // View customer details (open popup in View mode)
     function viewCustomer(rowIndex) {
        let customers = JSON.parse(localStorage.getItem('customers')) || [];
        const customer = customers[rowIndex];
        openPopup('view', customer);
    }

    // Edit customer details (open popup in Edit mode)
    function editCustomer(rowIndex) {
        let customers = JSON.parse(localStorage.getItem('customers')) || [];
        const customer = customers[rowIndex];
        openPopup('edit', customer);
    }

    // Update an existing customer
    function updateCustomer(updatedCustomer, index) {
        let customers = JSON.parse(localStorage.getItem('customers')) || [];
        customers[index] = updatedCustomer; // Update customer in array
        localStorage.setItem('customers', JSON.stringify(customers));
        // Reload the table
        accountsTable.innerHTML = ''; // Clear table
        loadCustomers(); // Reload table with updated customers
    }

    // Delete customer from table and localStorage
    function deleteCustomer(rowIndex) {
        let customers = JSON.parse(localStorage.getItem('customers')) || [];
        customers.splice(rowIndex, 1); // Remove customer from array
        localStorage.setItem('customers', JSON.stringify(customers));
        // Reload the table
        accountsTable.innerHTML = ''; // Clear table
        loadCustomers(); // Reload table with remaining customers
    }
</script>


  


      <a href="support.html" class="user-account"><i class="ri-customer-service-2-line"></i>
        Support</a>



      <div>

      </div>
  </section>































  <script>
    let sidebar = document.querySelector(".sidebar");
    let closeBtn = document.querySelector("#btn");
    let searchBtn = document.querySelector(".bx-search");
    let submenus = document.querySelectorAll('.submenu');  // Select all submenus
    
    // To keep track of submenus that were open before the sidebar was closed
    let previouslyOpenSubmenus = [];
    
    // Dropdown elements for Asset Management
    let assetManagementBtn = document.getElementById('assetManagementBtn');
    let assetManagementSubmenu = document.getElementById('assetManagementSubmenu');
    let chevron = document.getElementById('chevron');
    
    // Dropdown elements for Non Utilized Funds (nested dropdown)
    let nonUtilizedFundsBtn = document.getElementById('nonUtilizedFundsBtn');
    let nonUtilizedFundsSubmenu = document.getElementById('nonUtilizedFundsSubmenu');
    let nonUtilizedChevron = document.getElementById('nonUtilizedChevron');
    
    // Dropdown elements for Deposits (nested dropdown inside Non Utilized Funds)
    let depositsBtn = document.getElementById('depositsBtn');
    let depositsSubmenu = document.getElementById('depositsSubmenu');
    let depositsChevron = document.getElementById('depositsChevron');
    
    // Dropdown elements for Deposits (nested dropdown inside Non Utilized Funds)
    let deposits2Btn = document.getElementById('deposits2Btn');
    let deposits2Submenu = document.getElementById('deposits2Submenu');
    let deposits2Chevron = document.getElementById('deposits2Chevron');
    
    // Dropdown elements for Customer Management
    let customerManagementBtn = document.getElementById('customerManagementBtn');
    let customerManagementSubmenu = document.getElementById('customerManagementSubmenu');
    let customerChevron = document.getElementById('customerChevron');
    
    // Dropdown elements for Customer Account
    let customerAccountBtn = document.getElementById('customerAccountBtn');
    let customerAccountSubmenu = document.getElementById('customerAccountSubmenu');
    let customerAccountChevron = document.getElementById('customerAccountChevron');
    
    // Dropdown elements for Account Management
    let accountManagementBtn = document.getElementById('accountManagementBtn');
    let accountManagementSubmenu = document.getElementById('accountManagementSubmenu');
    let accountManagementChevron = document.getElementById('accountManagementChevron');
    
    // Function to toggle submenu with animation
    function toggleSubmenu(submenu, chevronIcon) {
        submenu.classList.toggle('open');
        
        if (submenu.classList.contains('open')) {
            submenu.style.maxHeight = submenu.scrollHeight + "px";  // Set height to auto-expand
            chevronIcon.classList.add('rotate');
        } else {
            submenu.style.maxHeight = 0;  // Collapse the submenu
            chevronIcon.classList.remove('rotate');
        }
    }
    
    // Account Management submenu toggle functionality
    accountManagementBtn.addEventListener('click', () => {
      if (sidebar.classList.contains("open")) {
        toggleSubmenu(accountManagementSubmenu, accountManagementChevron);  // Toggle submenu with animation
      }
    });
    
    // Customer Account submenu toggle functionality
    customerAccountBtn.addEventListener('click', () => {
      if (sidebar.classList.contains("open")) {
        toggleSubmenu(customerAccountSubmenu, customerAccountChevron);  // Toggle submenu with animation
      }
    });
    
    // Asset Management submenu toggle functionality
    assetManagementBtn.addEventListener('click', () => {
      if (sidebar.classList.contains("open")) {
        toggleSubmenu(assetManagementSubmenu, chevron);  // Toggle submenu with animation
      }
    });
    
    // Non Utilized Funds submenu toggle functionality (nested submenu)
    nonUtilizedFundsBtn.addEventListener('click', () => {
      if (sidebar.classList.contains("open")) {
        toggleSubmenu(nonUtilizedFundsSubmenu, nonUtilizedChevron);  // Toggle submenu with animation
      }
    });
    
    // Deposits submenu toggle functionality (nested submenu)
    depositsBtn.addEventListener('click', () => {
      if (sidebar.classList.contains("open")) {
        toggleSubmenu(depositsSubmenu, depositsChevron);  // Toggle submenu with animation
      }
    });
    
    // Deposits2 submenu toggle functionality (nested submenu)
    deposits2Btn.addEventListener('click', () => {
      if (sidebar.classList.contains("open")) {
        toggleSubmenu(deposits2Submenu, deposits2Chevron);  // Toggle submenu with animation
      }
    });
    
    // Customer Management submenu toggle functionality
    customerManagementBtn.addEventListener('click', () => {
      if (sidebar.classList.contains("open")) {
        toggleSubmenu(customerManagementSubmenu, customerChevron);  // Toggle submenu with animation
      }
    });
    
    // Function to toggle sidebar open/close and store the state
    closeBtn.addEventListener("click", () => {
      if (sidebar.classList.contains("open")) {
        // Save the state of open submenus before closing
        storeOpenSubmenus();
        closeAllSubmenus();  // Close submenus before closing the sidebar
        setTimeout(() => {
          sidebar.classList.remove("open");
          menuBtnChange();
          toggleChevronDisplay();
          localStorage.setItem('sidebarState', 'closed');
        }, 300);  // Adjust this delay as needed
      } else {
        sidebar.classList.add("open");
        menuBtnChange();
        toggleChevronDisplay();
        reopenPreviouslyOpenSubmenus();  // Restore open submenus
        localStorage.setItem('sidebarState', 'open');
      }
    });
    
    // Search button click also toggles sidebar open/close
    searchBtn.addEventListener("click", () => {
      if (sidebar.classList.contains("open")) {
        storeOpenSubmenus();  // Save the state of open submenus
        closeAllSubmenus();
        setTimeout(() => {
          sidebar.classList.remove("open");
          menuBtnChange();
          toggleChevronDisplay();
          localStorage.setItem('sidebarState', 'closed');
        }, 300);
      } else {
        sidebar.classList.add("open");
        menuBtnChange();
        toggleChevronDisplay();
        reopenPreviouslyOpenSubmenus();
        localStorage.setItem('sidebarState', 'open');
      }
    });
    
    // Store the open submenus before closing the sidebar
    function storeOpenSubmenus() {
      previouslyOpenSubmenus = [];
      submenus.forEach(submenu => {
        if (submenu.classList.contains('open')) {
          previouslyOpenSubmenus.push(submenu);
        }
      });
    }
    
    // Reopen submenus that were open before the sidebar closed
    function reopenPreviouslyOpenSubmenus() {
      previouslyOpenSubmenus.forEach(submenu => {
        submenu.classList.add('open');
        submenu.style.maxHeight = submenu.scrollHeight + "px";  // Restore maxHeight
        let chevronIcon = submenu.previousElementSibling.querySelector('.bx-chevron-down');
        if (chevronIcon) {
          chevronIcon.classList.add('rotate');
        }
      });
    }
    
    // Close all submenus function
    function closeAllSubmenus() {
      submenus.forEach(submenu => {
        submenu.classList.remove('open');
        submenu.style.maxHeight = 0;  // Collapse submenu
        let chevronIcon = submenu.previousElementSibling.querySelector('.bx-chevron-down');
        if (chevronIcon) {
          chevronIcon.classList.remove('rotate');
        }
      });
    }
    
    // Check the stored sidebar state on page load
    document.addEventListener("DOMContentLoaded", () => {
      const sidebarState = localStorage.getItem('sidebarState');
      if (sidebarState === 'open') {
        sidebar.classList.add('open');
        menuBtnChange();
        toggleChevronDisplay();
      } else if (sidebarState === 'closed') {
        sidebar.classList.remove('open');
        menuBtnChange();
        toggleChevronDisplay();
      }
    });
    
    // Functionality for buttons with the 'dropdown-toggle' class to open side menu if it's closed
    document.querySelectorAll('.dropdown-toggle').forEach(btn => {
      btn.addEventListener('click', () => {
        if (!sidebar.classList.contains('open')) {
          sidebar.classList.add('open');
          menuBtnChange();
          toggleChevronDisplay();
          const submenu = btn.nextElementSibling;
          const chevronIcon = btn.querySelector('.bx-chevron-down');
          if (submenu && chevronIcon) {
            submenu.style.maxHeight = submenu.scrollHeight + "px";  // Open submenu
            chevronIcon.classList.add('rotate');
          }
        }
      });
    });
    
    // Function to toggle chevron display when sidebar is opened/closed
    function toggleChevronDisplay() {
      let chevrons = document.querySelectorAll('.bx-chevron-down');
      if (sidebar.classList.contains("open")) {
        chevrons.forEach(chevron => {
          chevron.style.display = "block";
        });
      } else {
        chevrons.forEach(chevron => {
          chevron.style.display = "none";
        });
      }
    }
    
    // Optional: Change menu button icon when clicked
    function menuBtnChange() {
      if (sidebar.classList.contains("open")) {
        closeBtn.classList.replace("bx-menu", "bx-menu-alt-right");
      } else {
        closeBtn.classList.replace("bx-menu-alt-right", "bx-menu");
      }
    }
    
    
    </script>
    
    
    
    
    
    <!-- Time & Date -->
    <script>
        function updateClock() {
            const clockElement = document.getElementById("digitalClock");
            const now = new Date();
            
            let hours = now.getHours();
            let minutes = now.getMinutes();
            let ampm = hours >= 12 ? 'PM' : 'AM';
    
            hours = hours % 12;
            hours = hours ? hours : 12; // Convert hour '0' to '12'
            minutes = minutes < 10 ? '0' + minutes : minutes;
    
            const currentTime = hours + ':' + minutes + ' ' + ampm;
            clockElement.innerHTML = currentTime;
        }
    
        function updateDate() {
            const dateElement = document.getElementById("currentDate");
            const now = new Date();
            
            const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const months = [
                'January', 'February', 'March', 'April', 'May', 'June',
                'July', 'August', 'September', 'October', 'November', 'December'
            ];
    
            const dayOfWeek = days[now.getDay()];
            const dayOfMonth = now.getDate();
            const month = months[now.getMonth()];
            const year = now.getFullYear();
    
            const suffix = (dayOfMonth % 10 === 1 && dayOfMonth !== 11) ? 'st' :
                           (dayOfMonth % 10 === 2 && dayOfMonth !== 12) ? 'nd' :
                           (dayOfMonth % 10 === 3 && dayOfMonth !== 13) ? 'rd' : 'th';
    
            const currentDate = `${dayOfWeek} ${dayOfMonth}${suffix} ${year}`;
            dateElement.innerHTML = currentDate;
        }
    
        setInterval(updateClock, 1000); // Update clock every second
        updateClock(); // Initial call to display the clock immediately
        updateDate();  // Display the current date immediately
    </script>
    
    
    
    
    
    
    <script>
        // Universal function to check if a user is logged in
        function checkLoginStatus() {
            const loggedInUser = localStorage.getItem('loggedInUser');
            if (!loggedInUser) {
                // If no user is logged in, redirect to the login page
                window.location.href = 'login.html';
            }
        }
        
        // Call the function on page load
        checkLoginStatus();
        
        </script>
    
    <script>
        // Function to display the company name
        function displayCompanyName() {
            // Get the logged-in user's email from localStorage
            const loggedInUserEmail = localStorage.getItem('loggedInUser');
    
            if (loggedInUserEmail) {
                // Retrieve the user data using the email as the key
                const userData = JSON.parse(localStorage.getItem('user_' + loggedInUserEmail));
    
                if (userData && userData.companyName) {
                    // Update the innerHTML of the div with the company name
                    document.querySelector('.name').innerHTML = userData.companyName;
                }
            } else {
                // If no user is logged in, redirect to login page
                window.location.href = 'login.html';
            }
        }
    
        // Call the function on page load
        displayCompanyName();
    </script>
    
        
    
        
    <!-- Date & Time -->
        <script>
          function displayLastLogoutTime() {
        const lastLogoutTimeString = localStorage.getItem('lastLogoutTime');
    
        if (lastLogoutTimeString) {
            const lastLogoutTime = new Date(lastLogoutTimeString);
            const currentTime = new Date();
            const timeDifference = currentTime - lastLogoutTime;
            const millisecondsInADay = 24 * 60 * 60 * 1000;
    
            let timeLabel = '';
            const lastLogoutDate = lastLogoutTime.getDate();
            const currentDate = currentTime.getDate();
    
            if (currentDate === lastLogoutDate) {
                timeLabel = 'Today';
            } else if (currentDate - lastLogoutDate === 1) {
                timeLabel = 'Yesterday';
            } else {
                const daysAgo = Math.floor(timeDifference / millisecondsInADay);
                if (daysAgo <= 7) {
                    timeLabel = `${daysAgo} days ago`;
                } else {
                    const options = { weekday: 'long', month: 'long', day: 'numeric' };
                    timeLabel = lastLogoutTime.toLocaleDateString(undefined, options);
                }
            }
    
            const timeOptions = { hour: 'numeric', minute: 'numeric', hour12: true };
            const formattedTime = lastLogoutTime.toLocaleTimeString(undefined, timeOptions);
    
            // Update the innerHTML of the h4 inside the #lastLogout div
            document.getElementById('lastLogout').querySelector('h4').innerHTML = `<strong>${timeLabel},</strong> ${formattedTime}`;
        } else {
            // If there's no logout time stored, display a default message
            document.getElementById('lastLogout').querySelector('h4').innerHTML = '<strong>Never Logged Out</strong>';
        }
    }
    
    // Call the function on page load
    displayLastLogoutTime();
    
        </script>
    
    
    
    <!-- Logout -->
    <script>
      
        function logout() {
            // Save the current time as the logout time
            const logoutTime = new Date();
            localStorage.setItem('lastLogoutTime', logoutTime);
        
            // Remove the login data from localStorage
            localStorage.removeItem('loggedInUser');
            
            // Redirect to the login page
            window.location.href = 'login.html';
        }
        
        </script>
    
    <script>
        // Function to handle logging out
    function logout() {
        // Remove the login data from localStorage
        localStorage.removeItem('loggedInUser');
        
        // Redirect the user to the login page
        window.location.href = 'login.html';
    }
    
    // Attach the logout function to the logout icon
    document.getElementById('log_out').addEventListener('click', logout);
    
    </script>
    
    </body>
    </html>